# -*- coding: utf-8 -*-

class Test(object):
    def fetch_balance(self):
        res = {'RESPONSE': 'SUCCESS',
                'AGGR_ID': 'CUST0383',
                'CORP_ID': 'ESSDEEKN22052020',
                'USER_ID': 'MANOJKUM',
                'URN': 'URN',
                'ACCOUNTNO': '106151000003',
                'DATE': '05/09/20 09:37:22',
                'EFFECTIVEBAL': '960368.91',
                'CURRENCY': 'INR'}
        return {'account_no':res['ACCOUNTNO'], 'date': res['DATE'], 'balance': res['EFFECTIVEBAL'], 'currency': res['CURRENCY']}

    def fetch_statement(self):
        stmt = []
        res = {'URN': 'URN',
                'AGGR_ID': 'CUST0383',
                'CORP_ID': 'ESSDEEKN22052020',
                'USER_ID': 'MANOJKUM',
                'Record': [{'VALUEDATE': '18-08-2020',
                'AMOUNT': '5,00,000.00',
                'CHEQUENO': '',
                'TXNDATE': '18-08-2020 08:16:34',
                'REMARKS': 'INF/INFT/022621727671/MAA VAISHNO TRA',
                'TRANSACTIONID': 'S20263769',
                'TYPE': 'CR',
                'BALANCE': '-32,18,756.36'},
                {'VALUEDATE': '18-08-2020',
                'AMOUNT': '1,19,467.00',
                'CHEQUENO': '',
                'TXNDATE': '18-08-2020 09:58:49',
                'REMARKS': 'CLG/DENIM POINT/012116/IDB/17.08.2020',
                'TRANSACTIONID': 'S21697183',
                'TYPE': 'CR',
                'BALANCE': '-30,99,289.36'},
                {'VALUEDATE': '18-08-2020',
                'AMOUNT': '1,30,811.00',
                'CHEQUENO': '',
                'TXNDATE': '18-08-2020 10:04:11',
                'REMARKS': 'MMT/IMPS/023110087224/Essdee/KHUSHI HOS/Union Bank Of I',
                'TRANSACTIONID': 'S21815854',
                'TYPE': 'CR',
                'BALANCE': '-29,68,478.36'},
                {'VALUEDATE': '18-08-2020',
                'AMOUNT': '10,00,000.00',
                'CHEQUENO': '',
                'TXNDATE': '18-08-2020 10:21:09',
                'REMARKS': 'INF/INFT/022622112331/Essdee 003     /Essdee8580',
                'TRANSACTIONID': 'S22115863',
                'TYPE': 'DR',
                'BALANCE': '-39,68,478.36'},
                {'VALUEDATE': '18-08-2020',
                'AMOUNT': '52,010.00',
                'CHEQUENO': '',
                'TXNDATE': '18-08-2020 11:06:44',
                'REMARKS': 'NEFT-PUNBH20231620024-J S K  TRADERS--0424002100139374-PUNB0042400',
                'TRANSACTIONID': 'S23045675',
                'TYPE': 'CR',
                'BALANCE': '-39,16,468.36'},
                {'VALUEDATE': '18-08-2020',
                'AMOUNT': '1,91,266.00',
                'CHEQUENO': '',
                'TXNDATE': '18-08-2020 11:49:25',
                'REMARKS': 'MMT/IMPS/023111122740/MB: 13TH JUNE /ANAND HAND/Kotak Mahindra',
                'TRANSACTIONID': 'S23913661',
                'TYPE': 'CR',
                'BALANCE': '-37,25,202.36'},
                {'VALUEDATE': '18-08-2020',
                'AMOUNT': '1,50,000.00',
                'CHEQUENO': '',
                'TXNDATE': '18-08-2020 12:01:07',
                'REMARKS': 'NEFT-BKIDN20231803869-SANWARIYA READYMADE-SELF-664320110000358-BKID0000200',
                'TRANSACTIONID': 'S24134460',
                'TYPE': 'CR',
                'BALANCE': '-35,75,202.36'},
                {'VALUEDATE': '18-08-2020',
                'AMOUNT': '25,607.00',
                'CHEQUENO': '',
                'TXNDATE': '18-08-2020 12:03:43',
                'REMARKS': 'NEFT-N231201217577874-RONAK TRADERS-TRN0000000213743-809021101001544-HDFC0CDMCBD',
                'TRANSACTIONID': 'S24186488',
                'TYPE': 'CR',
                'BALANCE': '-35,49,595.36'},
                {'VALUEDATE': '18-08-2020',
                'AMOUNT': '52,763.00',
                'CHEQUENO': '',
                'TXNDATE': '18-08-2020 12:31:58',
                'REMARKS': 'NEFT-BKIDN20231801777-AALISHAN HOSIERY   READYMADE-AALISHAN HOSIERY-72602011000',
                'TRANSACTIONID': 'S24750033',
                'TYPE': 'CR',
                'BALANCE': '-34,96,832.36'},
                {'VALUEDATE': '18-08-2020',
                'AMOUNT': '1,63,565.00',
                'CHEQUENO': '',
                'TXNDATE': '18-08-2020 13:33:21',
                'REMARKS': 'NEFT-SAA227154332-SUVADRA TEXTILES-/FAST/-04390510000472-UCBA0000439',
                'TRANSACTIONID': 'S25985256',
                'TYPE': 'CR',
                'BALANCE': '-33,33,267.36'},
                {'VALUEDATE': '18-08-2020',
                'AMOUNT': '25,159.00',
                'CHEQUENO': '',
                'TXNDATE': '18-08-2020 13:42:52',
                'REMARKS': 'NEFT-SBIN420231470859-JINDAL CLOTH STORES KUNKURIPR-/ATTN//INB-0000001123370042',
                'TRANSACTIONID': 'S26157850',
                'TYPE': 'CR',
                'BALANCE': '-33,08,108.36'},
                {'VALUEDATE': '18-08-2020',
                'AMOUNT': '1,00,000.00',
                'CHEQUENO': '',
                'TXNDATE': '18-08-2020 13:46:02',
                'REMARKS': 'NEFT-UTBIE20231415812-BALAJI--1904050001090-UTBI0PTQM23',
                'TRANSACTIONID': 'S26217858',
                'TYPE': 'CR',
                'BALANCE': '-32,08,108.36'},
                {'VALUEDATE': '18-08-2020',
                'AMOUNT': '59,665.00',
                'CHEQUENO': '',
                'TXNDATE': '18-08-2020 14:08:51',
                'REMARKS': 'NEFT-BARBB20231232409-SHREE KRISHNA HOSIERY-/URGENT/-192911031087-BARB0DBSRIX',
                'TRANSACTIONID': 'S26620266',
                'TYPE': 'CR',
                'BALANCE': '-31,48,443.36'},
                {'VALUEDATE': '18-08-2020',
                'AMOUNT': '50,000.00',
                'CHEQUENO': '',
                'TXNDATE': '18-08-2020 15:32:49',
                'REMARKS': 'NEFT-ALLAH20231363138-M/S  SHREE KRISHNA ENTERPRISERS-SKE-00000050381043617-ALL',
                'TRANSACTIONID': 'S28099072',
                'TYPE': 'CR',
                'BALANCE': '-30,98,443.36'},
                {'VALUEDATE': '18-08-2020',
                'AMOUNT': '56,432.00',
                'CHEQUENO': '',
                'TXNDATE': '18-08-2020 15:47:49',
                'REMARKS': 'CLG/RAWAT/000242/KMB/23.07.2020',
                'TRANSACTIONID': 'S28335375',
                'TYPE': 'CR',
                'BALANCE': '-30,42,011.36'},
                {'VALUEDATE': '18-08-2020',
                'AMOUNT': '1,00,000.00',
                'CHEQUENO': '',
                'TXNDATE': '18-08-2020 16:05:11',
                'REMARKS': 'NEFT-000134940587-SHREE RAJAVEER HOSIERY-/URGENT/-324401010029227-UBIN0532444',
                'TRANSACTIONID': 'S28660076',
                'TYPE': 'CR',
                'BALANCE': '-29,42,011.36'},
                {'VALUEDATE': '18-08-2020',
                'AMOUNT': '70,463.00',
                'CHEQUENO': '',
                'TXNDATE': '18-08-2020 16:08:22',
                'REMARKS': 'NEFT-BKIDN20231880006-PREETAM FASHION-F-870320110000504-BKID0008703',
                'TRANSACTIONID': 'S28713692',
                'TYPE': 'CR',
                'BALANCE': '-28,71,548.36'},
                {'VALUEDATE': '18-08-2020',
                'AMOUNT': '1,37,696.00',
                'CHEQUENO': '',
                'TXNDATE': '18-08-2020 16:34:04',
                'REMARKS': 'NEFT-AXMB202315262890-NAMRATA COLLECTION AND HOSIERY--914020024430461-UTIB00012',
                'TRANSACTIONID': 'S29137116',
                'TYPE': 'CR',
                'BALANCE': '-27,33,852.36'},
                {'VALUEDATE': '18-08-2020',
                'AMOUNT': '1,00,000.00',
                'CHEQUENO': '',
                'TXNDATE': '18-08-2020 16:41:11',
                'REMARKS': 'NEFT-PUNBH20231750537-SAKSHAM TRADERS--0094008700012049-PUNB0009400',
                'TRANSACTIONID': 'S29265859',
                'TYPE': 'CR',
                'BALANCE': '-26,33,852.36'},
                {'VALUEDATE': '18-08-2020',
                'AMOUNT': '40,049.00',
                'CHEQUENO': '',
                'TXNDATE': '18-08-2020 16:42:49',
                'REMARKS': 'NEFT-PUNBH20231753726-RAJSHREE GARMENTS--3607008700021611-PUNB0360700',
                'TRANSACTIONID': 'S29294694',
                'TYPE': 'CR',
                'BALANCE': '-25,93,803.36'},
                {'VALUEDATE': '18-08-2020',
                'AMOUNT': '87,585.00',
                'CHEQUENO': '',
                'TXNDATE': '18-08-2020 17:32:08',
                'REMARKS': 'NEFT-IBKL200818289422-SHYAM FASHION--1660102000006811-IBKL0001660',
                'TRANSACTIONID': 'S30139274',
                'TYPE': 'CR',
                'BALANCE': '-25,06,218.36'},
                {'VALUEDATE': '18-08-2020',
                'AMOUNT': '76,656.00',
                'CHEQUENO': '',
                'TXNDATE': '18-08-2020 17:49:02',
                'REMARKS': 'NEFT-KKBKH20231841133-KUNDHANI ENTERPRISE-PAYMENT-08182120003700-KKBK0000958',
                'TRANSACTIONID': 'S30428992',
                'TYPE': 'CR',
                'BALANCE': '-24,29,562.36'},
                {'VALUEDATE': '18-08-2020',
                'AMOUNT': '64,395.00',
                'CHEQUENO': '',
                'TXNDATE': '18-08-2020 17:52:25',
                'REMARKS': 'NEFT-SDL66989272-GURU KIRPA TRADERS-/EBANK/-01821300000877-PSIB0000182',
                'TRANSACTIONID': 'S30492344',
                'TYPE': 'CR',
                'BALANCE': '-23,65,167.36'},
                {'VALUEDATE': '18-08-2020',
                'AMOUNT': '1,51,883.00',
                'CHEQUENO': '',
                'TXNDATE': '18-08-2020 19:02:07',
                'REMARKS': 'NEFT-BARBQ20231618794-GARG ENTERPRISES--45060400000043-BARB0CHANDP',
                'TRANSACTIONID': 'S31842181',
                'TYPE': 'CR',
                'BALANCE': '-22,13,284.36'},
                {'VALUEDATE': '18-08-2020',
                'AMOUNT': '1,00,000.00',
                'CHEQUENO': '',
                'TXNDATE': '18-08-2020 19:36:36',
                'REMARKS': 'NEFT-0818i26242508561-R K HOSIERY--0509102000002561-IBKL0NEFT01',
                'TRANSACTIONID': 'S32528713',
                'TYPE': 'CR',
                'BALANCE': '-21,13,284.36'}],
                'RESPONSE': 'SUCCESS',
                'ACCOUNTNO': '106151000003'}
        for record in res['Record']:
            stmt.append({'txn_date':record['TXNDATE'],
                        'credit': record['AMOUNT'] if record['TYPE']== 'CR' else 0,
                        'debit': record['AMOUNT'] if record['TYPE']== 'DR' else 0,
                        'balance': record['BALANCE'],
                        'remarks': record['REMARKS']})
        return stmt